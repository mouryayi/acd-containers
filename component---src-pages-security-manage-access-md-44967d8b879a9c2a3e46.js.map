{"version":3,"sources":["webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/index.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/LastModifiedDate.js","webpack:///./node_modules/gatsby-theme-carbon/src/templates/Default.js","webpack:///./node_modules/gatsby-theme-carbon/src/components/EditLink/EditLink.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageTabs/PageTabs.module.scss","webpack:///./src/pages/security/manage-access.md","webpack:///./node_modules/gatsby-theme-carbon/src/components/LastModifiedDate/last-modified-date.module.scss","webpack:///./node_modules/gatsby-theme-carbon/src/components/PageHeader/PageHeader.module.scss"],"names":["PageHeader","title","theme","tabs","className","cx","styles","pageHeader","withTabs","length","darkMode","id","text","EditLink","relativePagePath","repositoryProp","repository","useStaticQuery","site","siteMetadata","baseUrl","subDirectory","href","branch","row","link","PageTabs","render","this","props","slug","currentTab","split","filter","Boolean","slice","pageTabs","map","tab","slugifiedTab","slugify","lower","strict","selected","currentTabRegex","RegExp","replace","key","selectedItem","listItem","to","tabsContainer","aria-label","list","React","Component","LastModifiedDate","date","lastModified","Date","toLocaleDateString","day","year","month","Default","pageContext","children","location","Title","frontmatter","titleType","frontmatterTheme","description","keywords","interiorTheme","useMetadata","pathPrefix","pathname","Layout","homepage","pageTitle","pageDescription","pageKeywords","label","Main","padded","NextPrevious","Utils","module","exports","_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"sOAEeA,ECGI,SAAC,GAAD,MAAGC,EAAH,EAAGA,MAAOC,EAAV,EAAUA,MAAV,IAAiBC,YAAjB,MAAwB,GAAxB,SACjB,mBACEC,UAAWC,IAAGC,IAAOC,YAAR,OACVD,IAAOE,UAAWL,EAAKM,OADb,EAEVH,IAAOI,UAAqB,SAAVR,EAFR,KAIb,mBAAKE,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,iBACb,kBAAIO,GAAG,aAAaP,UAAWE,IAAOM,MACnCX,Q,YCbEY,ECIE,SAAC,GAAsD,IAApDC,EAAmD,EAAnDA,iBAA8BC,EAAqB,EAAjCC,WAGhBA,EAEhBC,yBAAe,cAHjBC,KACEC,aAAgBH,WAHiD,EAmB3BD,GAAkBC,EAApDI,EAnB6D,EAmB7DA,QAASC,EAnBoD,EAmBpDA,aAEXC,EAAUF,EAAN,SArB2D,EAmBtCG,OAEUF,EAA/B,aAAwDP,EAElE,OAAOM,EACL,mBAAKhB,UAAS,WAAaoB,OACzB,mBAAKpB,UAAU,WACb,iBAAGA,UAAWqB,OAAMH,KAAMA,GAA1B,8BAKF,M,oCCnCSI,E,kGCabC,OAAA,WAAU,IAAD,EACuBC,KAAKC,MAA3B5B,EADD,EACCA,MAAOE,EADR,EACQA,KAAM2B,EADd,EACcA,KACfC,EAAaD,EAAKE,MAAM,KAAKC,OAAOC,SAASC,OAAO,GAAG,GAEvDC,EAAWjC,EAAKkC,KAAI,SAACC,GAAS,IAAD,EAC3BC,EAAeC,IAAQF,EAAK,CAAEG,OAAO,EAAMC,QAAQ,IACnDC,EAAWJ,IAAiBR,EAG5Ba,EAAkB,IAAIC,OAAUd,EAAd,aAClBT,EAAOQ,EAAKgB,QAAQF,EAAiBL,GAC3C,OACE,kBAAIQ,IAAKT,EAAKlC,UAAWC,KAAE,OAAI2C,gBAAeL,EAAnB,GAA+BM,aACxD,YAAC,OAAD,CAAM7C,UAAWqB,OAAMyB,GAAE,GAAK5B,GAC3BgB,OAMT,OACE,mBAAKlC,UAAW+C,iBACd,mBAAK/C,UAAU,YACb,mBAAKA,UAAU,WACb,mBAAKA,UAAU,mCACb,mBAAKgD,aAAYnD,GACf,kBAAIG,UAAWiD,QAAOjB,S,GA3BAkB,IAAMC,W,yDCZ7BC,ECEU,SAAC,GAAc,IAAZC,EAAW,EAAXA,KAOpBC,EAAe,IAAIC,KAAKF,GAE9B,OAAOA,EACL,YAAC,IAAD,CAAKrD,UAAWE,IAAOkB,KACrB,YAAC,IAAD,KACE,mBAAKpB,UAAWE,IAAOM,MAAvB,sBACsB8C,EAAaE,mBAAmB,QAZ5C,CACdC,IAAK,UACLC,KAAM,UACNC,MAAO,YAcL,MCyESC,IAjFC,SAAC,GAAgD,IAA9CC,EAA6C,EAA7CA,YAAaC,EAAgC,EAAhCA,SAAUC,EAAsB,EAAtBA,SAAUC,EAAY,EAAZA,MAAY,EACJH,EAAlDI,mBADsD,MACxC,GADwC,EACpCvD,EAAgCmD,EAAhCnD,iBAAkBwD,EAAcL,EAAdK,UAE1CnE,EAMEkE,EANFlE,KACAF,EAKEoE,EALFpE,MACOsE,EAILF,EAJFnE,MACAsE,EAGEH,EAHFG,YACAC,EAEEJ,EAFFI,SACAhB,EACEY,EADFZ,KAGMiB,EAAkBC,cAAlBD,cAIEE,EACN3D,yBAAe,cADjBC,KAAQ0D,WAUJ9C,EAAO8C,EACTT,EAASU,SAAS/B,QAAQ8B,EAAY,IACtCT,EAASU,SAUP9C,EAPC5B,EAEH2B,EAAKE,MAAM,KAAKC,OAAOC,SAASC,OAAO,GAAG,IAC1CK,IAAQrC,EAAK,GAAI,CAAEsC,OAAO,IAHV,GASdvC,EAAQqE,GAAoBG,EAElC,OACE,YAACI,EAAA,EAAD,CACE3E,KAAMA,EACN4E,UAAU,EACV7E,MAAOA,EACP8E,UAAW/E,EACXgF,gBAAiBT,EACjBU,aAAcT,EACdH,UAAWA,GACX,YAAC,EAAD,CACErE,MAAOmE,EAAQ,YAACA,EAAD,MAAYnE,EAC3BkF,MAAM,QACNhF,KAAMA,EACND,MAAOA,IAERC,GACC,YAAC,EAAD,CACEF,MAAOA,EACP6B,KAAMA,EACN3B,KAAMA,EACN4B,WAAYA,IAGhB,YAACqD,EAAA,EAAD,CAAMC,QAAM,GACTnB,EACD,YAAC,EAAD,CAAUpD,iBAAkBA,IAC5B,YAAC,EAAD,CAAkB2C,KAAMA,KAE1B,YAAC6B,EAAA,EAAD,CACErB,YAAaA,EACbE,SAAUA,EACVrC,KAAMA,EACN3B,KAAMA,EACN4B,WAAYA,IAEd,YAACwD,EAAA,EAAD,S,qBCzFNC,EAAOC,QAAU,CAAC,kBAAoB,iDAAiD,oBAAsB,mDAAmD,KAAO,+BAA+B,IAAM,gC,qBCA5MD,EAAOC,QAAU,CAAC,kBAAoB,iDAAiD,oBAAsB,mDAAmD,cAAgB,yCAAyC,KAAO,+BAA+B,SAAW,oCAAoC,KAAO,+BAA+B,aAAe,0C,8LCOtVC,G,UAAe,IACtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGlE,EACF,8BACD,OAAO,YAAC+D,EAAD,eAAeD,EAAiB9D,EAAhC,CAAuCkE,WAAYA,EAAYC,QAAQ,cAG5E,gDACA,6MAA4L,iBAAGC,WAAW,IACtM,KAAQ,4CADgL,SAA5L,kJAGmF,iBAAGA,WAAW,IAC7F,KAAQ,yHADuE,qBAHnF,gCAMA,sBACE,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,uGACA,mBAAKA,WAAW,MAAK,oBAAMA,WAAW,OAAjB,kDAGvB,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,oGACA,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,qCAApB,uCACA,kBAAIA,WAAW,MAAf,oCAAyD,0BAAYA,WAAW,MAAvB,qDAAzD,sGACA,kBAAIA,WAAW,MAAf,gBAAqC,0BAAYA,WAAW,MAAvB,gGAArC,yEAEF,mBAAKA,WAAW,MAAK,oBAAMA,WAAW,MAClC,UAAa,gBACb,WAAc,8BACd,+BAA+B,GAHd,mgFAqFvB,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,OAA2B,0BAAYA,WAAW,KAAvB,qCAA3B,qDAEF,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAK,0BAAYA,WAAW,KAAvB,6CACnB,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAf,0LAGJ,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,4BAAgD,0BAAYA,WAAW,KAAvB,6BAAhD,kNAAwU,0BAAYA,WAAW,KAAvB,yBAAxU,kBACA,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,mGAApB,sCAGJ,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,uoBACA,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,4EACpB,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,gJAGxB,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,gDACA,kBAAIA,WAAW,MACb,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,gEAApB,gUAGJ,kBAAIA,WAAW,MACb,iBAAGA,WAAW,MAAd,mIACN,0BAAYA,WAAW,KAAvB,sLAGE,2MAA0L,0BAAYA,WAAW,KAAvB,OAA1L,mLAA6Z,iBAAGA,WAAW,IACva,KAAQ,oFADiZ,oFAA7Z,gdAI+E,iBAAGA,WAAW,IACzF,KAAQ,sGADmE,+BAJ/E,kFAM2H,iBAAGA,WAAW,IACrI,KAAQ,uDAD+G,oBAN3H,KASA,gFAA+D,iBAAGA,WAAW,IACzE,KAAQ,kEADmD,yBAA/D,KAGA,mFAAkE,iBAAGA,WAAW,IAC5E,KAAQ,oEADsD,mCAAlE,KAGA,+CACA,g3BAA+1B,0BAAYA,WAAW,KAAvB,oBAA/1B,uGAAmgC,0BAAYA,WAAW,KAAvB,kCAAngC,8EACA,mDACA,odACA,oGAAmF,0BAAYA,WAAW,KAAvB,0BAAnF,8DAAoN,0BAAYA,WAAW,KAAvB,yBAApN,2FACA,4TAA2S,0BAAYA,WAAW,KAAvB,4CAA3S,iCAAia,0BAAYA,WAAW,KAAvB,uCAAja,KACA,qBAAG,sBAAQA,WAAW,KAAnB,SAAH,oKAAiN,iBAAGA,WAAW,IAC3N,KAAQ,6EADqM,4CAGjN,+BACA,sBACE,kBAAIA,WAAW,MAAf,4NACA,kBAAIA,WAAW,MAAf,gKAAqL,0BAAYA,WAAW,MAAvB,sBAArL,QAA6P,0BAAYA,WAAW,MAAvB,gBAA7P,oMAEF,iCACA,uBAAK,oBAAMA,WAAW,OAAjB,oeAcL,+BACA,0WAKJH,EAAWI,gBAAiB,G,qBC/M5BV,EAAOC,QAAU,CAAC,kBAAoB,2DAA2D,oBAAsB,6DAA6D,KAAO,yCAAyC,IAAM,0C,qBCA1OD,EAAOC,QAAU,CAAC,kBAAoB,mDAAmD,oBAAsB,qDAAqD,WAAa,wCAAwC,SAAW,sCAAsC,SAAW,sCAAsC,KAAO","file":"component---src-pages-security-manage-access-md-44967d8b879a9c2a3e46.js","sourcesContent":["import PageHeader from './PageHeader';\n\nexport default PageHeader;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport cx from 'classnames';\nimport styles from './PageHeader.module.scss';\n\nconst PageHeader = ({ title, theme, tabs = [] }) => (\n  <div\n    className={cx(styles.pageHeader, {\n      [styles.withTabs]: tabs.length,\n      [styles.darkMode]: theme === 'dark',\n    })}>\n    <div className=\"bx--grid\">\n      <div className=\"bx--row\">\n        <div className=\"bx--col-lg-12\">\n          <h1 id=\"page-title\" className={styles.text}>\n            {title}\n          </h1>\n        </div>\n      </div>\n    </div>\n  </div>\n);\n\nPageHeader.propTypes = {\n  /**\n   * Specify the title for the page\n   */\n  title: PropTypes.node,\n};\n\nexport default PageHeader;\n","import EditLink from './EditLink';\n\nexport default EditLink;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql, useStaticQuery } from 'gatsby';\n\nimport { link, row } from './EditLink.module.scss';\n\nconst EditLink = ({ relativePagePath, repository: repositoryProp }) => {\n  const {\n    site: {\n      siteMetadata: { repository },\n    },\n  } = useStaticQuery(graphql`\n    query REPOSITORY_QUERY {\n      site {\n        siteMetadata {\n          repository {\n            baseUrl\n            subDirectory\n            branch\n          }\n        }\n      }\n    }\n  `);\n\n  const { baseUrl, subDirectory, branch } = repositoryProp || repository;\n\n  const href = `${baseUrl}/edit/${branch}${subDirectory}/src/pages${relativePagePath}`;\n\n  return baseUrl ? (\n    <div className={`bx--row ${row}`}>\n      <div className=\"bx--col\">\n        <a className={link} href={href}>\n          Edit this page on GitHub\n        </a>\n      </div>\n    </div>\n  ) : null;\n};\n\nEditLink.propTypes = {\n  repository: PropTypes.shape({\n    baseUrl: PropTypes.string,\n    subDirectory: PropTypes.string,\n    branch: PropTypes.string,\n  }),\n  relativePagePath: PropTypes.string,\n};\n\nexport default EditLink;\n","import PageTabs from './PageTabs';\n\nexport default PageTabs;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { Link } from 'gatsby';\nimport slugify from 'slugify';\nimport cx from 'classnames';\n\nimport {\n  tabsContainer,\n  list,\n  selectedItem,\n  listItem,\n  link,\n} from './PageTabs.module.scss';\n\nexport default class PageTabs extends React.Component {\n  render() {\n    const { title, tabs, slug } = this.props;\n    const currentTab = slug.split('/').filter(Boolean).slice(-1)[0];\n\n    const pageTabs = tabs.map((tab) => {\n      const slugifiedTab = slugify(tab, { lower: true, strict: true });\n      const selected = slugifiedTab === currentTab;\n      // matches with or without trailing slash: /?\n      // matches with or without hash link: (#.*)?\n      const currentTabRegex = new RegExp(`${currentTab}/?(#.*)?$`);\n      const href = slug.replace(currentTabRegex, slugifiedTab);\n      return (\n        <li key={tab} className={cx({ [selectedItem]: selected }, listItem)}>\n          <Link className={link} to={`${href}`}>\n            {tab}\n          </Link>\n        </li>\n      );\n    });\n\n    return (\n      <div className={tabsContainer}>\n        <div className=\"bx--grid\">\n          <div className=\"bx--row\">\n            <div className=\"bx--col-lg-12 bx--col-no-gutter\">\n              <nav aria-label={title}>\n                <ul className={list}>{pageTabs}</ul>\n              </nav>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nPageTabs.propTypes = {\n  tabs: PropTypes.array,\n  slug: PropTypes.string,\n};\n","import LastModifiedDate from './LastModifiedDate';\n\nexport default LastModifiedDate;\n","import React from 'react';\nimport { Row, Column } from '../Grid';\nimport styles from './last-modified-date.module.scss';\n\nconst LastModifiedDate = ({ date }) => {\n  const options = {\n    day: '2-digit',\n    year: 'numeric',\n    month: 'long',\n  };\n\n  const lastModified = new Date(date);\n\n  return date ? (\n    <Row className={styles.row}>\n      <Column>\n        <div className={styles.text}>\n          Page last updated: {lastModified.toLocaleDateString('en-GB', options)}\n          {/* // https://www-03preprod.ibm.com/support/knowledgecenter/ibm_style/dates-and-times.html */}\n        </div>\n      </Column>\n    </Row>\n  ) : null;\n};\nexport default LastModifiedDate;\n","import React from 'react';\nimport slugify from 'slugify';\nimport { useStaticQuery, graphql } from 'gatsby';\n\nimport Utils from '../components/Utils';\nimport Layout from '../components/Layout';\nimport PageHeader from '../components/PageHeader';\nimport EditLink from '../components/EditLink';\nimport NextPrevious from '../components/NextPrevious';\nimport PageTabs from '../components/PageTabs';\nimport Main from '../components/Main';\nimport useMetadata from '../util/hooks/useMetadata';\nimport LastModifiedDate from '../components/LastModifiedDate';\n\nconst Default = ({ pageContext, children, location, Title }) => {\n  const { frontmatter = {}, relativePagePath, titleType } = pageContext;\n  const {\n    tabs,\n    title,\n    theme: frontmatterTheme,\n    description,\n    keywords,\n    date,\n  } = frontmatter;\n\n  const { interiorTheme } = useMetadata();\n\n  // get the path prefix if it exists\n  const {\n    site: { pathPrefix },\n  } = useStaticQuery(graphql`\n    query PATH_PREFIX_QUERY {\n      site {\n        pathPrefix\n      }\n    }\n  `);\n\n  // let gatsby handle prefixing\n  const slug = pathPrefix\n    ? location.pathname.replace(pathPrefix, '')\n    : location.pathname;\n\n  const getCurrentTab = () => {\n    if (!tabs) return '';\n    return (\n      slug.split('/').filter(Boolean).slice(-1)[0] ||\n      slugify(tabs[0], { lower: true })\n    );\n  };\n\n  const currentTab = getCurrentTab();\n\n  const theme = frontmatterTheme || interiorTheme;\n\n  return (\n    <Layout\n      tabs={tabs}\n      homepage={false}\n      theme={theme}\n      pageTitle={title}\n      pageDescription={description}\n      pageKeywords={keywords}\n      titleType={titleType}>\n      <PageHeader\n        title={Title ? <Title /> : title}\n        label=\"label\"\n        tabs={tabs}\n        theme={theme}\n      />\n      {tabs && (\n        <PageTabs\n          title={title}\n          slug={slug}\n          tabs={tabs}\n          currentTab={currentTab}\n        />\n      )}\n      <Main padded>\n        {children}\n        <EditLink relativePagePath={relativePagePath} />\n        <LastModifiedDate date={date} />\n      </Main>\n      <NextPrevious\n        pageContext={pageContext}\n        location={location}\n        slug={slug}\n        tabs={tabs}\n        currentTab={currentTab}\n      />\n      <Utils />\n    </Layout>\n  );\n};\n\nexport default Default;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"EditLink-module--bx--text-truncate--end--2pqje\",\"bxTextTruncateFront\":\"EditLink-module--bx--text-truncate--front--3_lIE\",\"link\":\"EditLink-module--link--1qzW3\",\"row\":\"EditLink-module--row--1B9Gk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageTabs-module--bx--text-truncate--end--267NA\",\"bxTextTruncateFront\":\"PageTabs-module--bx--text-truncate--front--3xEQF\",\"tabsContainer\":\"PageTabs-module--tabs-container--8N4k0\",\"list\":\"PageTabs-module--list--3eFQc\",\"listItem\":\"PageTabs-module--list-item--nUmtD\",\"link\":\"PageTabs-module--link--1mDJ1\",\"selectedItem\":\"PageTabs-module--selected-item--YPVr3\"};","import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/IBM/acd-containers/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2>{`Managing Access to ACD`}</h2>\n    <p>{`If you have applications that run outside of the cluster and want to provide secure access to the ACD service in the cluster you can use the Openshift provided OAuth service with a `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/openshift/oauth-proxy\"\n      }}>{`proxy`}</a>{` and a service account to do RBAC access to the service.\nIn the example below we’ll use the latest version of the openshift oauth proxy.  See `}<a parentName=\"p\" {...{\n        \"href\": \"https://catalog.redhat.com/software/containers/openshift4/ose-oauth-proxy/5cdb2133bed8bd5717d5ae64?container-tabs=gti\"\n      }}>{`instructions here`}</a>{` for how to pull this image.`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Create a project/namespace for the proxy to run in (the examples below used ibm-wh-acd-oauth-proxy)`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`oc create namespace ibm-wh-acd-oauth-proxy\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Download the yaml below and save it as ibm-wh-acd-oauth-proxy.yaml.  Edit it with these changes:`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`namespace: ibm-wh-acd-oauth-proxy`}</inlineCode>{` to the namespace you created in 1.`}</li>\n          <li parentName=\"ul\">{`In the args section on this line `}<inlineCode parentName=\"li\">{`--upstream=https://ibm-wh-acd-acd.<namespace>.svc`}</inlineCode>{`  - change <namespace`}{`>`}{` to the namespace your acd instance is running in (the target service)`}</li>\n          <li parentName=\"ul\">{`On this line `}<inlineCode parentName=\"li\">{`--openshift-delegate-urls={\"/\":{\"resource\":\"services\",\"verb\":\"get\",\"namespace\":<namespace>}}`}</inlineCode>{`- change <namespace`}{`>`}{` again to match your target acd namespace.`}</li>\n        </ul>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-yaml\",\n            \"metastring\": \"ibm-wh-acd-oauth-proxy.yaml\",\n            \"ibm-wh-acd-oauth-proxy.yaml\": true\n          }}>{` kind: List\n apiVersion: v1\n items:\n # Create a proxy service account and ensure it will use the route \"proxy\"\n - apiVersion: v1\n   kind: ServiceAccount\n   metadata:\n     name: proxy\n     annotations:\n       serviceaccounts.openshift.io/oauth-redirectreference.primary: '{\"kind\":\"OAuthRedirectReference\",\"apiVersion\":\"v1\",\"reference\":{\"kind\":\"Route\",\"name\":\"proxy\"}}'\n # Create a secure connection to the proxy via a route\n - apiVersion: route.openshift.io/v1\n   kind: Route\n   metadata:\n     name: proxy\n   spec:\n     to:\n       kind: Service\n       name: proxy\n     tls:\n       termination: Reencrypt\n - apiVersion: v1\n   kind: Service\n   metadata:\n     name: proxy\n     annotations:\n       service.alpha.openshift.io/serving-cert-secret-name: proxy-tls\n   spec:\n     ports:\n     - name: proxy\n       port: 443\n       targetPort: 8443\n     selector:\n       app: proxy\n # Launch a proxy as a deployment\n # use           - --set-xauthrequest=true option to send back the user info in the response to nginx or client\n # see https://catalog.redhat.com/software/containers/openshift4/ose-oauth-proxy/5cdb2133bed8bd5717d5ae64?container-tabs=gti\n - apiVersion: apps/v1\n   kind: Deployment\n   metadata:\n     name: proxy\n   spec:\n     replicas: 1\n     selector:\n       matchLabels:\n         app: proxy\n     template:\n       metadata:\n         labels:\n           app: proxy\n       spec:\n         serviceAccountName: proxy\n         containers:\n         - name: oauth-proxy\n           image: registry.redhat.io/openshift4/ose-oauth-proxy:v4.8\n           imagePullPolicy: IfNotPresent\n           ports:\n           - containerPort: 8443\n             name: public\n           args:\n           - --https-address=:8443\n           - --provider=openshift\n           - --request-logging=true\n           - --openshift-service-account=proxy\n           - --upstream=https://ibm-wh-acd-acd.<namespace>.svc\n           - --openshift-delegate-urls={\"/\":{\"resource\":\"services\",\"verb\":\"get\",\"namespace\":\"<namespace>\"}}\n           - --ssl-insecure-skip-verify=false\n           - --upstream-ca=/var/run/secrets/kubernetes.io/serviceaccount/service-ca.crt\n           - --tls-cert=/etc/tls/private/tls.crt\n           - --tls-key=/etc/tls/private/tls.key\n           - --cookie-secret=SECRET\n           - --footer=-\n           volumeMounts:\n           - mountPath: /etc/tls/private\n             name: proxy-tls\n         volumes:\n         - name: proxy-tls\n           secret:\n             secretName: proxy-tls\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Run `}<inlineCode parentName=\"p\">{`oc project ibm-wh-acd-oauth-proxy`}</inlineCode>{` (change to your project used in  step 1 above).`}</p>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\"><inlineCode parentName=\"p\">{`oc create -f ibm-wh-acd-oauth-proxy.yaml`}</inlineCode></p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">{`This should create a deployment for the proxy, a service to that deployment, a route to that service and a proxy service account all in your new project that was created in step 1.`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Because we are using the `}<inlineCode parentName=\"p\">{`--openshift-delegate-urls`}</inlineCode>{` option of the proxy we need to give the service account that checks the token permission to create a tokenreviews at the cluster level.  We’ll do this by binding the proxy service account to the predefined `}<inlineCode parentName=\"p\">{`system:auth-delegator`}</inlineCode>{` cluster role.`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`oc adm policy add-cluster-role-to-user system:auth-delegator -z proxy -n ibm-wh-acd-oauth-proxy`}</inlineCode>{` (change project name as needed)`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The delegate-urls above says it will check the user/token coming in has the ability to do a get on the services in the target namespace as what will check to ensure the service account has access to the target acd instance.   We need to create a namespace-scoped role on the target acd project and grant access to the service account that will be used to call acd.  To start, create a role (named serviceview) on the namespace where acd is running and bind that role to the service account created above. Change <namespace`}{`>`}{` to your acd namespace and ibm-wh-acd-oauth-proxy to the namespace/project created in step 1 where the proxy runs.`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`oc create role serviceview --verb=get --resource=service -n <namespace>`}</inlineCode></li>\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`oc adm policy add-role-to-user serviceview system:serviceaccount:ibm-wh-acd-oauth-proxy:proxy --role-namespace=<namespace> -n <namespace>`}</inlineCode></li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Create a token to use on the service account`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><inlineCode parentName=\"li\">{`oc serviceaccounts new-token proxy -n ibm-wh-acd-oauth-proxy`}</inlineCode>{`  (change the project name as needed).  Copy the token returned (not this is also stored in a secret named proxy-token-nnnnn in the target project and when you delete that it will remove the token from the account after a bit. You can add additional tokens and remove the secret to rotate your tokens for your app.`}</li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use that token as a bearer token to call acd through the proxy route passing the bearer token on the Authorization header (eg:\n`}<inlineCode parentName=\"p\">{`curl -X GET -H \"Authorization: Bearer eyJ....z9g\" -k \"https://proxy-ibm-wh-acd-oauth-proxy.apps.youserver.com/services/clinical_data_annotator/api/v1/flows?version=2021-05-18\"`}</inlineCode></p>\n      </li>\n    </ol>\n    <p>{`The delegate-urls parms says for which paths it should forward and what the caller needs to have access to allow it.  In this example we forward all calls (’/’) if the caller has `}<inlineCode parentName=\"p\">{`get`}</inlineCode>{` access to the services in the target acd namespace  (which we created the role and granted that permission the service account).  More info on openshift RBAC access is here - `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.7/authentication/using-rbac.html\"\n      }}>{`https://docs.openshift.com/container-platform/4.7/authentication/using-rbac.html`}</a>{`\nNote here we have the proxy service account doing double duty - it is used to run the proxy service and do the token review (so it needed that cluster role binding) and we have it as the service account that is calling into ACD and bound it to that serviceview role to allow it.  In practice you have many service accounts and use their tokens to act as different acd tenants.\nAlso note if your application runs in the cluster you may want to consider using `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.openshift.com/container-platform/4.7/authentication/bound-service-account-tokens.html\"\n      }}>{`bound service access tokens`}</a>{` to have the tokens dynamically generated and rotated by the kubelet using the `}<a parentName=\"p\" {...{\n        \"href\": \"https://jpweber.io/blog/a-look-at-tokenrequest-api/\"\n      }}>{`TokenRequest api`}</a>{`.`}</p>\n    <p>{`More options and details for the proxy are available at `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/openshift/oauth-proxy#openshift-oauth-proxy\"\n      }}>{`OpenShift OAuth Proxy`}</a>{`.`}</p>\n    <p>{`Information on troubleshooting the OAuth Proxy is found at `}<a parentName=\"p\" {...{\n        \"href\": \"/acd-containers/troubleshooting/troubleshooting-the-oauth-proxy/\"\n      }}>{`Troubleshooting the OAuth Proxy`}</a>{`.`}</p>\n    <h3>{`Multitenancy with ACD`}</h3>\n    <p>{`ACD is stateless as far as the text it analyzes and returns however it does store configuration data through cartridges and flows and profiles and associated configuration artifacts.  You can use a single ACD instance with multiple ‘tenants’ which provides each tenant its own configuration storage area.  In order to use multitenancy you must use a security proxy as described above and use a different service account for each tenant. That provides security and passes back the tenant through a header to ACD but ACD needs to be configured to honor that header (it will use a defaultTenant as a tenant value for all calls otherwise).  In the ACD deployment (operand) when you create the instance you can set the tenantHeader value in the custom resource definition to specify the header to use as the tenant.  With the OAuth proxy above use the value of `}<inlineCode parentName=\"p\">{`X-Forwarded-User`}</inlineCode>{` (which the proxy sets to the service account name).  In the ACD custom resource definition this is `}<inlineCode parentName=\"p\">{`tenantHeader: X-Forwarded-User`}</inlineCode>{`.  You can edit or patch your instance to change or set it at create time.`}</p>\n    <h3>{`Network Policies with ACD`}</h3>\n    <p>{`A set of Network Policies are created in the target ACD name space during the installation process. These Network Policies will only allow network traffic to flow from the ACD macro service to its back-end micro services within the same namespace.  The ACD macro service will also accept incoming connections from any namespace to port 9443 (via the ACD Service object) such as a Route ingress pod, Proxy pod, or other cluster application pod.`}</p>\n    <p>{`You can disable the Network Policy creation from the web console by setting `}<inlineCode parentName=\"p\">{`Network policy enabled`}</inlineCode>{` to false.  When installing from the command line, set the `}<inlineCode parentName=\"p\">{`networkPolicy.enabled`}</inlineCode>{` property to false.  This will remove any networking restrictions in the ACD namespace.`}</p>\n    <p>{`You can further enhance security by only allowing the ACD macro service to accept network traffic from a specific source namespace and/or its pods.  This can be done during instance creation in the web console by using the YAML View and adding network policy ingress selectors definitions at `}<inlineCode parentName=\"p\">{`spec.networkPolicy.ingress.fromSelectors`}</inlineCode>{`.  From the command line, set `}<inlineCode parentName=\"p\">{`networkPolicy.ingress.fromSelectors`}</inlineCode>{`.`}</p>\n    <p><strong parentName=\"p\">{`Note:`}</strong>{` Creating Network Policy definitions is an advanced topic and requires a good understanding of Network Policies configurations. More information can be found at `}<a parentName=\"p\" {...{\n        \"href\": \"https://kubernetes.io/docs/concepts/services-networking/network-policies/\"\n      }}>{`Kubernetes Network Policy Documentation`}</a></p>\n    <p>{`Steps:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Use an existing kubernetes label or add one to the source’s namespace or deployment descriptor.  This label is used in the network policy to determine which incoming network traffic is allowed into the macro service.`}</li>\n      <li parentName=\"ol\">{`Modify the ACD instance yaml configuration (CSV) from the web console by adding a yaml block to the fromSelectors object.  There are two types of selectors, `}<inlineCode parentName=\"li\">{`namespaceSelectors`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`podSelectors`}</inlineCode>{`.  Choose one or both depending on the scope of restriction you want.  These selectors will get added to the networkpolicy-acd-macroservice.yaml NetworkPolicy definition in the ACD namespace.`}</li>\n    </ol>\n    <p>{`Example:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`spec:\n  networkPolicy:\n    enabled: true\n    ingress:\n      fromSelectors:\n      - namespaceSelector:\n          matchLabels:\n            <label name>: <label value>\n        podSelector:\n          matchLabels:\n            <label name>: <label value>\n\n# Note that the use of the hyphen (-) on the selectors determines if this restriction is an AND or OR rule.  In the above example, both the namespace and pod selectors have to match since they are in the same array.\n`}</code></pre>\n    <p>{`Egress`}</p>\n    <p>{`There are no egress Network Policies defined for the ACD namespace by default.  All pods within the ACD namespace can send data outside of the namespace including to the internet unless you have other restrictions in place.  It is also possible to restrict egress traffic from within the ACD namespace using Network Policy egress rules.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      ","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"last-modified-date-module--bx--text-truncate--end--123zi\",\"bxTextTruncateFront\":\"last-modified-date-module--bx--text-truncate--front--3xeKz\",\"text\":\"last-modified-date-module--text--24m-4\",\"row\":\"last-modified-date-module--row--2BquN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bxTextTruncateEnd\":\"PageHeader-module--bx--text-truncate--end--mZWeX\",\"bxTextTruncateFront\":\"PageHeader-module--bx--text-truncate--front--3zvrI\",\"pageHeader\":\"PageHeader-module--page-header--3hIan\",\"darkMode\":\"PageHeader-module--dark-mode--hBrwL\",\"withTabs\":\"PageHeader-module--with-tabs--3nKxA\",\"text\":\"PageHeader-module--text--o9LFq\"};"],"sourceRoot":""}